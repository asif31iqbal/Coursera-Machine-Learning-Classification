define("bundles/ondemand/components/InstructorMessage",["require","exports","module","react-with-addons","react-bootstrap","underscore","vendor/cnpm/fluxible.v0-4/addons/connectToStores","bundles/ondemand/constants/InstructorMessageTypes","bundles/ondemand/actions/InstructorMessageActions","bundles/phoenix/components/ProfileImage","bundles/ondemand/shapes/InstructorMessageProfile","bundles/ui/components/CollapsibleMessage","js/lib/coursera.store","css!bundles/ondemand/components/__styles__/InstructorMessage"],function(require,exports,module){"use strict";function _defaults(e,o){for(var s=Object.getOwnPropertyNames(o),t=0;t<s.length;t++){var r=s[t],n=Object.getOwnPropertyDescriptor(o,r);n&&n.configurable&&void 0===e[r]&&Object.defineProperty(e,r,n)}return e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):_defaults(t,e))}var r=function(){function defineProperties(n,r){for(var t=0;t<r.length;t++){var e=r[t];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(n,e.key,e)}}return function(e,t,r){return t&&defineProperties(e.prototype,t),r&&defineProperties(e,r),e}}(),s=function get(s,u,l){var r=!0;e:for(;r;){var t=s,a=u,i=l;r=!1,null===t&&(t=Function.prototype);var e=Object.getOwnPropertyDescriptor(t,a);if(void 0===e){var n=Object.getPrototypeOf(t);if(null===n)return void 0;s=n,u=a,l=i,r=!0,e=n=void 0;continue e}if("value"in e)return e.value;var o=e.get;if(void 0===o)return void 0;return o.call(i)}},e=require("react-with-addons"),u=require("react-bootstrap"),l=u.OverlayTrigger,g=u.Tooltip,_=require("underscore"),y=require("vendor/cnpm/fluxible.v0-4/addons/connectToStores"),t=require("bundles/ondemand/constants/InstructorMessageTypes"),o=require("bundles/ondemand/actions/InstructorMessageActions"),c=o.getModuleMessage,p=o.getWelcomeMessage,d=o.getThankYouMessage,m=require("bundles/phoenix/components/ProfileImage"),a=require("bundles/ondemand/shapes/InstructorMessageProfile"),f=require("bundles/ui/components/CollapsibleMessage"),n=require("js/lib/coursera.store");require("css!bundles/ondemand/components/__styles__/InstructorMessage");var i=function(t){function InstructorImage(){_classCallCheck(this,InstructorImage),s(Object.getPrototypeOf(InstructorImage.prototype),"constructor",this).apply(this,arguments)}return _inherits(InstructorImage,t),r(InstructorImage,[{key:"render",value:function render(){var t=this.props.instructor;return e.createElement(m,{profileImageUrl:t.photo,fullName:t.fullName,width:50,height:50,imgParams:{auto:"fit",fit:"crop"},alt:this.props.alt})}}],[{key:"propTypes",value:{instructor:a.isRequired,alt:e.PropTypes.string},enumerable:!0}]),InstructorImage}(e.Component),h=function(t){function TooltipInstructorImage(){_classCallCheck(this,TooltipInstructorImage),s(Object.getPrototypeOf(TooltipInstructorImage.prototype),"constructor",this).apply(this,arguments)}return _inherits(TooltipInstructorImage,t),r(TooltipInstructorImage,[{key:"render",value:function render(){var t=this.props.instructor,r=e.createElement(g,null,t.fullName);return e.createElement(l,{placement:"top",overlay:r,key:t.id},e.createElement("div",{className:"instructor-image-container"},e.createElement(i,{instructor:t,alt:t.fullName})))}}],[{key:"propTypes",value:{instructor:a.isRequired},enumerable:!0}]),TooltipInstructorImage}(e.Component),v=function(o){function InstructorMessage(t,r){var e=this;_classCallCheck(this,InstructorMessage),s(Object.getPrototypeOf(InstructorMessage.prototype),"constructor",this).call(this,t,r),this.onToggleClick=function(){var t=n.get(e.getLocalStorageKey());n.set(e.getLocalStorageKey(),!t)}}return _inherits(InstructorMessage,o),r(InstructorMessage,null,[{key:"propTypes",value:{type:e.PropTypes.oneOf([t.WELCOME,t.MODULE,t.THANK_YOU]).isRequired,moduleId:e.PropTypes.string,message:e.PropTypes.string,instructors:e.PropTypes.arrayOf(a)},enumerable:!0},{key:"contextTypes",value:{executeAction:e.PropTypes.func.isRequired,week:e.PropTypes.number},enumerable:!0},{key:"defaultProps",value:{message:"",instructors:[]},enumerable:!0}]),r(InstructorMessage,[{key:"componentWillMount",value:function componentWillMount(){this.props.moduleId?this.context.executeAction(c,{moduleId:this.props.moduleId}):this.props.type===t.WELCOME?this.context.executeAction(p):this.context.executeAction(d)}},{key:"componentWillUnmount",value:function componentWillUnmount(){n.set(this.getLocalStorageKey(),!0)}},{key:"getLocalStorageKey",value:function getLocalStorageKey(){var t=this.props.type,e=this.props.moduleId;return e||(e=t),"messageHide"+e}},{key:"renderInstructors",value:function renderInstructors(){var t=this.props.instructors;if(1===t.length)return e.createElement("div",{className:"horizontal-box align-items-left align-items-vertical-center instructor-profile"},e.createElement(i,{instructor:t[0]}),e.createElement("p",{className:"headline-1-text instructor-name"},t[0].fullName));return e.createElement("div",{className:"horizontal-box align-items-left align-items-vertical-center instructor-profile"},t.map(function(t){return e.createElement(h,{instructor:t,key:t.id})}))}},{key:"render",value:function render(){var r=this.props,o=r.type,s=r.message,a=r.instructors;if((o===t.WELCOME||o===t.MODULE)&&!s)return null;var i=this.props.message.length>250;return e.createElement(f,{className:"rc-InstructorMessage",showToggle:i,onToggleClick:this.onToggleClick,isInitiallyCollapsed:n.get(this.getLocalStorageKey())},a.length>0&&this.renderInstructors(),this.props.message.length>0&&e.createElement("div",{key:_("message_").uniqueId(),dangerouslySetInnerHTML:{__html:this.props.message}}))}}]),InstructorMessage}(e.Component);module.exports=y(v,["InstructorMessageStore"],function(r,e){var n=r.InstructorMessageStore,o=e.moduleId,s=e.type,a=s===t.THANK_YOU?"end":"start";return n.getMessage(a,o)})});