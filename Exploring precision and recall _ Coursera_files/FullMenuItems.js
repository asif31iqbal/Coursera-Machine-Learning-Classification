define("bundles/ondemand/components/menu/FullMenuItems",["require","exports","module","q","react-with-addons","underscore","naptime","bundles/phoenix/template/models/userIdentity","bundles/course-references/components/CourseReferencesLink","bundles/course-references/components/CourseReferencesList","bundles/group-roster/components/GroupClassmatesPage","bundles/ondemand/components/CourseInfoPage","bundles/ondemand/components/menu/AdminButton","bundles/ondemand/components/menu/ForumSetList","bundles/ondemand/components/menu/MainNavItem","bundles/ondemand/components/menu/ModuleList","bundles/ondemand/stores/SessionStore","bundles/groups/models/Group","bundles/ondemand/constants/Constants","bundles/ondemand/utils/socialExperimentUtils","bundles/ondemand/utils/url","bundles/naptimejs/resources/onDemandPreviewingStates.v1","bundles/discussions/utils/ViewContextLoader","bundles/discussions/viewModels/viewContext","js/lib/getPropsFromPromise","js/lib/waitFor","pages/open-course/common/promises/courseAuthorization","i18n!nls/ondemand","vendor/cnpm/fluxible.v0-4/addons/connectToStores"],function(require,exports,module){"use strict";function _defaults(e,o){for(var r=Object.getOwnPropertyNames(o),t=0;t<r.length;t++){var n=r[t],s=Object.getOwnPropertyDescriptor(o,n);s&&s.configurable&&void 0===e[n]&&Object.defineProperty(e,n,s)}return e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):_defaults(t,e))}var I=function(){function defineProperties(s,n){for(var t=0;t<n.length;t++){var e=n[t];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(s,e.key,e)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}(),g=function get(r,a,u){var n=!0;e:for(;n;){var t=r,i=a,l=u;n=!1,null===t&&(t=Function.prototype);var e=Object.getOwnPropertyDescriptor(t,i);if(void 0===e){var s=Object.getPrototypeOf(t);if(null===s)return void 0;r=s,a=i,u=l,n=!0,e=s=void 0;continue e}if("value"in e)return e.value;var o=e.get;if(void 0===o)return void 0;return o.call(l)}},O=require("q"),e=require("react-with-addons"),_=require("underscore"),l=require("naptime"),a=require("bundles/phoenix/template/models/userIdentity"),u=require("bundles/course-references/components/CourseReferencesLink"),p=require("bundles/course-references/components/CourseReferencesList"),d=require("bundles/group-roster/components/GroupClassmatesPage"),c=require("bundles/ondemand/components/CourseInfoPage"),m=require("bundles/ondemand/components/menu/AdminButton"),v=require("bundles/ondemand/components/menu/ForumSetList"),n=require("bundles/ondemand/components/menu/MainNavItem"),b=require("bundles/ondemand/components/menu/ModuleList"),h=require("bundles/ondemand/stores/SessionStore"),f=require("bundles/groups/models/Group"),U=require("bundles/ondemand/constants/Constants"),t=U.mainNavItems,E=require("bundles/ondemand/utils/socialExperimentUtils"),S=E.isForumsBlacklisted,o=require("bundles/ondemand/utils/url"),C=o.getDiscussionsUrl,y=o.getHomeUrl,N=o.getAssignmentsUrl,i=o.getOfficeHoursUrl,P=require("bundles/naptimejs/resources/onDemandPreviewingStates.v1"),G=require("bundles/discussions/utils/ViewContextLoader"),w=require("bundles/discussions/viewModels/viewContext"),F=require("js/lib/getPropsFromPromise"),T=require("js/lib/waitFor"),M=require("pages/open-course/common/promises/courseAuthorization"),s=require("i18n!nls/ondemand"),x=require("vendor/cnpm/fluxible.v0-4/addons/connectToStores"),k=c.getUrl,r=function(o){function FullMenuItems(){_classCallCheck(this,FullMenuItems),g(Object.getPrototypeOf(FullMenuItems.prototype),"constructor",this).apply(this,arguments),this.state={canTeach:!1}}return _inherits(FullMenuItems,o),I(FullMenuItems,[{key:"componentWillMount",value:function componentWillMount(){var e=this;M.then(function(t){e.setState({canTeach:t.canTeach})}).done()}},{key:"render",value:function render(){var l=this.props,o=l.groupContext,r=l.eventGroup,c=l.previewState,h=c&&!!c.previewBranchId,f=e.createElement(n,{name:t.HOME,title:s("Home"),link:y(),selected:this.props.selectedItem===t.HOME,isItemNav:this.props.isItemNav}),I=e.createElement(n,{name:t.ASSIGNMENTS,title:s("Assignments"),link:N(),selected:this.props.selectedItem===t.ASSIGNMENTS,isItemNav:this.props.isItemNav}),a=!S(),g=e.createElement(n,{name:t.DISCUSSIONS,title:s("Discussions"),link:o?o.get("discussionsLink"):C(),selected:this.props.selectedItem===t.DISCUSSIONS,isItemNav:this.props.isItemNav,locked:h}),O=e.createElement(n,{name:t.OFFICE_HOURS,title:s("Office Hours"),link:i(),selected:this.props.selectedItem===t.OFFICE_HOURS,isItemNav:this.props.isItemNav}),P=e.createElement(n,{name:t.OFFICE_HOURS,title:s("Live Events"),link:i(),selected:this.props.selectedItem===t.OFFICE_HOURS,isItemNav:this.props.isItemNav}),G=e.createElement(n,{name:t.COURSE,title:s("Course Content"),link:this.props.scheduleUrl,selected:this.props.selectedItem===t.COURSE,isItemNav:this.props.isItemNav}),w=e.createElement(n,{name:t.CLASSMATES,title:s("Classmates"),link:d.getUrl(),selected:this.props.selectedItem===t.CLASSMATES,isItemNav:this.props.isItemNav,locked:h}),F=e.createElement(n,{name:t.INFO,title:s("Course Info"),link:k(),selected:this.props.selectedItem===t.INFO,isItemNav:this.props.isItemNav}),E=!_(this.props.rosterGroups).isEmpty()||this.state.canTeach;return e.createElement("ul",{className:"rc-FullMenuItems c-main-menu flex-1 vertical-box nostyle",onClick:this.props.hideMobileMenu},!this.props.isItemNav&&e.createElement(m,null),e.createElement("li",null,f),e.createElement("li",null,G),!this.props.isItemNav&&this.props.selectedItem===t.COURSE&&e.createElement(b,null),this.props.hasGradableItems&&e.createElement("li",null,I),a&&e.createElement("li",null,g),a&&o&&!this.props.isItemNav&&this.props.selectedItem===t.DISCUSSIONS&&e.createElement(v,{groupContext:o}),r&&r.isFacilitatedGroup()&&e.createElement("li",null,O),r&&!r.isFacilitatedGroup()&&e.createElement("li",null,P),E&&e.createElement("li",null,w),e.createElement("li",null,e.createElement(u,{isSelected:this.props.selectedItem===t.REFERENCES,isItemNav:this.props.isItemNav})),!this.props.isItemNav&&this.props.selectedItem===t.REFERENCES&&e.createElement(p,null),e.createElement("li",null,F))}}],[{key:"propTypes",value:{hideMobileMenu:e.PropTypes.func.isRequired,scheduleUrl:e.PropTypes.string.isRequired,hasGradableItems:e.PropTypes.bool.isRequired,selectedItem:e.PropTypes.string,isItemNav:e.PropTypes.bool,rosterGroups:e.PropTypes.array,groupContext:e.PropTypes.instanceOf(w),eventGroup:e.PropTypes.instanceOf(f),previewState:e.PropTypes.object,isEnrolled:e.PropTypes.bool},enumerable:!0},{key:"defaultProps",value:{isItemNav:!1,showEvents:!1},enumerable:!0}]),FullMenuItems}(e.Component);module.exports=_.compose(x(["CourseStore","FacilitatedStore","GroupEntitlementStore"],function(t,o){var n=t.CourseStore,s=t.FacilitatedStore,e=t.GroupEntitlementStore;return{hasLoaded:n.hasLoaded()&&s.hasLoaded()&&e.hasGroupsLoaded(),hasGradableItems:n.hasGradableItems(),rosterGroups:e.getMyGroupsWithRosterEnabled(),eventGroups:e.getMyGroupsWithEventsEnabled(),forumGroups:e.getMyGroupsWithForumsEnabled(),isEnrolled:h.isEnrolled()}}),T(function(e){var t=e.hasLoaded;return t}),F(function(e){var t=e.eventGroups,n=e.forumGroups,s=n.length>0?n[0].id:null,o=t.length>0?t[0]:null,r=s?G.loadGroupContext(s):O(null);return r.then(function(e){return{groupContext:e,eventGroup:o}})}),l.createContainer(function(e){var t=e.courseId,n=[a.get("id"),t].join("~");return{previewState:P.get(n,{required:!1,fields:["previewBranchId"]})}}))(r),module.exports.BaseComp=r});