define("bundles/ondemand/components/banners/BranchPreviewBanner",["require","exports","module","react-with-addons","underscore","vendor/cnpm/fluxible.v0-4/addons/connectToStores","naptime","js/lib/coursera.redirect","bundles/naptimejs/resources/onDemandPreviewingStates.v1","bundles/iconfont/Icon","bundles/phoenix/template/models/userIdentity","css!./__styles__/BranchPreviewBanner"],function(require,exports,module){"use strict";function _defaults(e,o){for(var i=Object.getOwnPropertyNames(o),t=0;t<i.length;t++){var r=i[t],n=Object.getOwnPropertyDescriptor(o,r);n&&n.configurable&&void 0===e[r]&&Object.defineProperty(e,r,n)}return e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):_defaults(t,e))}var l=function(){function defineProperties(n,r){for(var t=0;t<r.length;t++){var e=r[t];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(n,e.key,e)}}return function(e,t,r){return t&&defineProperties(e.prototype,t),r&&defineProperties(e,r),e}}(),o=function get(i,c,u){var r=!0;e:for(;r;){var t=i,a=c,s=u;r=!1,null===t&&(t=Function.prototype);var e=Object.getOwnPropertyDescriptor(t,a);if(void 0===e){var n=Object.getPrototypeOf(t);if(null===n)return void 0;i=n,c=a,u=s,r=!0,e=n=void 0;continue e}if("value"in e)return e.value;var o=e.get;if(void 0===o)return void 0;return o.call(s)}},e=require("react-with-addons"),i=require("underscore"),n=i.compose,a=require("vendor/cnpm/fluxible.v0-4/addons/connectToStores"),s=require("naptime"),c=require("js/lib/coursera.redirect"),t=require("bundles/naptimejs/resources/onDemandPreviewingStates.v1"),u=require("bundles/iconfont/Icon"),r=require("bundles/phoenix/template/models/userIdentity");require("css!./__styles__/BranchPreviewBanner");var p=function(n){function BranchPreviewBanner(){var e=this;_classCallCheck(this,BranchPreviewBanner),o(Object.getPrototypeOf(BranchPreviewBanner.prototype),"constructor",this).apply(this,arguments),this.exitPreviewMode=function(){var r={previewBranchId:null},n=t.update(e.props.previewState.id,r);e.context.executeMutation(n).then(function(r){var t="/teach/"+e.props.courseSlug+"/author/versions";c.setLocation(t)}).done()}}return _inherits(BranchPreviewBanner,n),l(BranchPreviewBanner,[{key:"render",value:function render(){var t=this.props.previewState,n=t&&!!t.previewBranchId,o=r.get("authenticated")&&(r.get("is_superuser")||this.props.hasTeachingRole);if(!o||!n)return null;return e.createElement("div",{className:"rc-BranchPreviewBanner horizontal-box align-items-vertical-center"},e.createElement("div",{className:"flex-1 horizontal-box"},e.createElement(u,{name:"info",className:"c-nav-icon color-warn"}),e.createElement("span",{className:"banner-text flex-1"},"You are currently previewing a version of this course. Discussions and Classmates are not available in Preview mode. To see updates made to the course material since you entered preview mode, please exit and re-enter preview mode.")),e.createElement("button",{className:"passive compact exit-button",onClick:this.exitPreviewMode},"Exit Preview Mode"))}}],[{key:"propTypes",value:{previewState:e.PropTypes.object,courseSlug:e.PropTypes.string,hasTeachingRole:e.PropTypes.bool},enumerable:!0},{key:"contextTypes",value:{executeMutation:e.PropTypes.func.isRequired},enumerable:!0}]),BranchPreviewBanner}(e.Component);module.exports=n(s.createContainer(function(e){var r=e.course.get("id"),n=[e.userId,r].join("~");return r?{courseSlug:e.course.get("slug"),previewState:t.get(n,{fields:["previewBranchId"]})}:{}}),a(["CourseMembershipStore"],function(e){var t=e.CourseMembershipStore;return{hasTeachingRole:t.hasTeachingRole()}}))(p)});